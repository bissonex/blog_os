{% extends "base.html" %}

{% block title %}{{ page.title }} | {{ config.title }}{% endblock title %}

{% block main %}
    <h1>{{ page.title }}</h1>
    <time datetime="{{ page.date | date(format="%Y-%m-%d") }}" class="post-date">
        {{ page.date | date(format="%b %d, %Y") }}
        {% if page.extra.updated %} (updated on {{ page.extra.updated | date(format="%b %d, %Y") }}) {% endif %}
    </time>
    <aside id="toc">
        <h2>Table of Contents</h2>
        <ol>
            {% for h2 in page.toc %}<li>
                <a href="{{h2.permalink | safe}}">{{ h2.title | safe }}</a>
                {% if h2.children %}<ol>
                    {% for h3 in h2.children %}<li>
                        <a href="{{h3.permalink | safe}}">{{ h3.title | safe }}</a>
                    </li>{% endfor %}
                </ol>{% endif %}
            </li>{% endfor %}
        </ol>
    </aside>
    {{ page.content | safe }}
{% endblock main %}

{% block after_main %}
    <hr>
    <div class="PageNavigation">
        {% if page.previous %}
            <a class="prev" href="{{ page.previous.permalink | safe }}">&laquo; {{ page.previous.title }}</a>
        {% endif %}
        {% if page.next %}
            <a class="next" href="{{ page.next.permalink | safe }}">{{ page.next.title }} &raquo;</a>
        {% endif %}
    </div>

    <hr>
    <section>
        <h2>Comments</h2>
        <!-- Remarkbox - Your readers want to communicate with you -->
        <div id="remarkbox-div">
            <noscript>
            <iframe id=remarkbox-iframe src="https://my.remarkbox.com/embed?nojs=true" style="height:600px;width:100%;border:none!important" tabindex=0></iframe>
            </noscript>
        </div>
        <script src="https://my.remarkbox.com/static/js/iframe-resizer/iframeResizer.min.js"></script>
        <script>
            var rb_owner_key = "27f5d646-d9cb-11e7-830c-040140774501";
            var thread_uri = window.location.href;
            var thread_fragment = window.location.hash;
            function create_remarkbox_iframe() {
            var src = "https://my.remarkbox.com/embed?rb_owner_key=" + rb_owner_key + "&thread_uri=" + thread_uri;
            var ifrm = document.createElement("iframe");
            ifrm.setAttribute("id", "remarkbox-iframe");
            ifrm.setAttribute("scrolling", "no");
            ifrm.setAttribute("src", src);
            ifrm.setAttribute("frameborder", "0");
            ifrm.setAttribute("tabindex", "0");
            ifrm.setAttribute("title", "Remarkbox");
            ifrm.style.width = "100%";
            document.getElementById("remarkbox-div").appendChild(ifrm);
            }
            create_remarkbox_iframe();
            iFrameResize(
            {
                checkOrigin: ["https://my.remarkbox.com"],
                inPageLinks: true,
                initCallback: function(e) {e.iFrameResizer.moveToAnchor(thread_fragment)}
            },
            document.getElementById("remarkbox-iframe")
            );
        </script>
    </section>

{% endblock after_main %}


